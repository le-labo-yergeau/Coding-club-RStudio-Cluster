<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sara Correa Garcia">

<title>Connect to RStudio using jupyterhub</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="RStudio-protocol_files/libs/clipboard/clipboard.min.js"></script>
<script src="RStudio-protocol_files/libs/quarto-html/quarto.js"></script>
<script src="RStudio-protocol_files/libs/quarto-html/popper.min.js"></script>
<script src="RStudio-protocol_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="RStudio-protocol_files/libs/quarto-html/anchor.min.js"></script>
<link href="RStudio-protocol_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="RStudio-protocol_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="RStudio-protocol_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="RStudio-protocol_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="RStudio-protocol_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Connect to RStudio using jupyterhub</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sara Correa Garcia </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="protocol-to-connect-to-rstudio-using-jupyterhub" class="level3">
<h3 class="anchored" data-anchor-id="protocol-to-connect-to-rstudio-using-jupyterhub">Protocol to connect to RStudio using jupyterhub</h3>
<p>To connect to RStudio from Jupyter Lab using the Compute Canada clusters, you can follow the steps below:</p>
<ol type="1">
<li><p>Open your browser and navigate to: <a href="https://jupyterhub.sharcnet.ca/hub/spawn">jupyterhub.sharcnet.ca</a>. After filling the login page with your Compute Canada credentials, you will be redirected to a page to fill your server request.</p>
<p><img src="images/Screen%20Shot%202023-07-03%20at%2011.25.27%20AM.png" class="img-fluid"></p></li>
<li><p>Fill in the fields according to your needs: Account, Time, Number of cores, Memory and GPU configuration.</p>
<ul>
<li><p><strong>Account</strong>: At mECO:labs, we usually have resources allocated in the Graham cluster (that is why we choose sharcnet to start the session). But you may have resources allocated in other clusters. To find out how many resources have been allocated to the group at a given time, you can visit<a href="https://ccdb.alliancecan.ca/">ccdb.alliancecan.ca</a>. Under the menu <strong><em>My Account</em></strong>, you can explore the section <em><strong>My Resources and Allocations</strong>.</em> At the moment of writing this, you will probably pick: rrg-profname_cpu.</p></li>
<li><p><strong>Time</strong>: The minimum time is 15 minutes (0.25 hours). This should be enough for the purpose of testing your first connection. The more time you ask for, the higher your chances to see your request denied. I have seen difficulties to get a time slot of 4 hours.</p></li>
<li><p><strong>Number</strong> <strong>of cores</strong>: To test 1 is enough. Asking for more cores in combination with GPUs is specially useful if your code is optimized for parallel computing.</p></li>
<li><p><strong>Memory</strong>: The memory you need. Usually more than what the limit of your computer is. However, if you require too much resources your request may not spawn at that given time. If you really need to visualize your code in the cluster as your go with a lot of memory, you can try to ask for large resources at a later time (such as in the evening). For more than 32 Gb of memory, it may be difficult to get the allocation you ask for and you should aim to submit the task as a batch job.</p></li>
<li><p><strong>GPU configuration</strong>: To determine which type of GPU you need you need to understand the types available. You can read more about Graham’s GPUs <a href="https://docs.alliancecan.ca/wiki/Graham">here</a>.</p></li>
</ul></li>
<li><p>Click start. Depending on the resources that you asked for, the session may take some time to start. You land in this page, and may stay there for some time (A).</p></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/log.png" class="img-fluid figure-img" width="706"></p>
<p></p><figcaption class="figure-caption">A. Server allocation request is pending in queue</figcaption><p></p>
</figure>
</div>
<p>If the time runs out (B), it probably means that the resources you asked for were not available at the moment. You can try to change your number of cores and memory, or relaunch the petition for resources later.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Screen%20Shot%202023-07-03%20at%2011.56.46%20AM.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">B. Server allocation failed: try at a later time, or reduce your request for resources</figcaption><p></p>
</figure>
</div>
<ol start="4" type="1">
<li><p>When your sever launches, you will get in this page:</p>
<p><img src="images/Screen%20Shot%202023-07-03%20at%2012.01.02%20PM.png" class="img-fluid"></p></li>
</ol>
<p>Here, you can open a python notebook automatically, or a terminal, as needed. We need to load a module to start RStudio.</p>
<ol start="5" type="1">
<li><p>To start RStudio, you will need to navigate to the modules tab, on the left menu:</p>
<p><img src="images/Screen%20Shot%202023-07-03%20at%2012.04.29%20PM.png" class="img-fluid"></p></li>
<li><p>In the search box, you can start typing RStudio, until the <code>rstudio-server</code> module becomes available at the bottom section. Click on the load button.</p>
<p><img src="images/Screen%20Shot%202023-07-03%20at%2012.05.10%20PM-01.png" class="img-fluid"></p></li>
<li><p>After a couple of seconds, a new RStudio icon will appear in the Launcher page. Click on it to start RStudio in a new navigation tab.</p>
<p><img src="images/Screen%20Shot%202023-07-03%20at%2012.06.23%20PM.png" class="img-fluid"></p></li>
<li><p>Notice that your current working directory is now located at your personal Compute Canada project’s directory. All the actions you perform here: deleting, renaming or creating files or folders, will be reflected in your project directory: be mindful of your clicking to avoid altering or removing important files. You can now create .Rproj as usual, following your typical project architecture. Also, this RStudio session won’t have access to the internet, so all the packages must be preinstalled in an interactive node session (check out the <a href="https://github.com/le-labo-yergeau/Coding-club-Compute_Canada">Compute Canada tutorial</a> to guide you through it). You can then load them as usual with the <code>library()</code> function. If you need to submit your data and your script to the cluster, you can do so following the instructions provided in the previously mentioned tutorial.</p></li>
</ol>
<p><img src="images/Screen%20Shot%202023-07-03%20at%2012.06.59%20PM-01.png" class="img-fluid"></p>
<p>And that’s it! Now you are ready to code in RStudio using the Compute Canada HPC resources.</p>
</section>
<section id="references-and-resources" class="level3">
<h3 class="anchored" data-anchor-id="references-and-resources">References and resources</h3>
<ul>
<li><p><a href="https://jupyterhub.sharcnet.ca/hub/spawn" class="uri">https://jupyterhub.sharcnet.ca/hub/spawn</a></p></li>
<li><p><a href="https://ccdb.alliancecan.ca/" class="uri">https://ccdb.alliancecan.ca/</a></p></li>
<li><p><a href="https://docs.alliancecan.ca/wiki/JupyterHub#JupyterHub_on_clusters" class="uri">https://docs.alliancecan.ca/wiki/JupyterHub#JupyterHub_on_clusters</a></p></li>
<li><p><a href="https://github.com/le-labo-yergeau/Coding-club-Compute_Canada" class="uri">https://github.com/le-labo-yergeau/Coding-club-Compute_Canada</a></p></li>
<li><p><a href="https://docs.alliancecan.ca/wiki/Graham" class="uri">https://docs.alliancecan.ca/wiki/Graham</a></p></li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>